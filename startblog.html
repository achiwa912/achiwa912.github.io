<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>org-mode + pelican + githubでブログを始めてみる &mdash; Dreaming in Brookline, MA 02445</title>
  <meta name="author" content="きょうす kyos">






  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">


    <link href="/favicon.png" rel="icon">

  <link href="/theme/css/main.css" media="screen, projection"
        rel="stylesheet" type="text/css">

  <link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
  <link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
</head>

<body>
  <header role="banner"><hgroup>
  <h1><a href="/">Dreaming in Brookline, MA 02445</a></h1>
</hgroup></header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
</ul>


<ul class="main-navigation">
    <li><a href="/pages/about.html">About</a></li>
      <li >
        <a href="/category/blog.html">Blog</a>
      </li>
      <li >
        <a href="/category/english.html">English</a>
      </li>
      <li >
        <a href="/category/linux.html">Linux</a>
      </li>
      <li >
        <a href="/category/python.html">Python</a>
      </li>
      <li class="active">
        <a href="/category/tech.html">Tech</a>
      </li>
</ul></nav>
  <div id="main">
    <div id="content">
<div>
  <article class="hentry" role="article">
<header>
      <h1 class="entry-title">org-mode + pelican + githubでブログを始めてみる</h1>
    <p class="meta">
<time datetime="2020-07-01T00:00:00-04:00" pubdate>Wed 01 July 2020</time>    </p>
</header>

  <div class="entry-content"><div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgdbf32c3">1. はじめに</a></li>
<li><a href="#orgdd11b0d">2. ブログを作る</a>
<ul>
<li><a href="#org6bb5250">2.1. emacs + org-mode</a></li>
<li><a href="#orga0c5b7d">2.2. どこのブログを使うか</a></li>
<li><a href="#orgb155400">2.3. どのサイトジェネレーターを使うか</a></li>
<li><a href="#org4e72e32">2.4. Pelicanを使ってみる</a>
<ul>
<li><a href="#org94d78b2">2.4.1. 仮想環境作成</a></li>
<li><a href="#org9216058">2.4.2. Pelicanの設定</a></li>
<li><a href="#org5a02ac6">2.4.3. テーマを設定する</a></li>
<li><a href="#org168d3f6">2.4.4. org-modeでPelicanを使う</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org5aa5a9c">3. ブログを公開する</a></li>
</ul>
</div>
</div>

<div id="outline-container-orgdbf32c3" class="outline-2">
<h2 id="orgdbf32c3"><span class="section-number-2">1</span> はじめに</h2>
<div class="outline-text-2" id="text-1">
<p>
こんにちは、初めまして。きょうす です。
最近20年振りにPythonでプログラミングすることを覚えて、作ったゲームを
githubに公開したのですが、調子に乗ってブログまで始めてみる気になりました。
折角なので、メモ代わりに使っているemacs + org-modeでできないか調べてみたら、
Pelicanというジェネレーターを使えばできそうなことがわかったので、挑戦して
みることにしました。
</p>

<p>
初回からいきなりマニアックな話題ですが、このブログでは技術的なことだけ
でなく、英語学習や英語教育についても取り上げていきたいと思います。
</p>
</div>
</div>

<div id="outline-container-orgdd11b0d" class="outline-2">
<h2 id="orgdd11b0d"><span class="section-number-2">2</span> ブログを作る</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org6bb5250" class="outline-3">
<h3 id="org6bb5250"><span class="section-number-3">2.1</span> emacs + org-mode</h3>
<div class="outline-text-3" id="text-2-1">
<p>
emacsというエディタをご存じでしょうか? かつて、vimと人気を2分するくらい
ポピュラーなエディタだったのですが、とにかくマニアックで、とてつもなく
急なラーニングカーブを誇っているためか、最近ではすっかり人気も陰り、
少なくとも私の周囲で使っている人は見当たりません。
</p>

<p>
私は今の会社に入社したときに、viとemacsの選択を迫られ、emacsの方が名前が
クールという理由で使い始めました。その後20余年、emacsが廃れずに生き残って
いるのは驚きです。私は指がemacsのキー操作に慣れてしまったため、もはや
他のエディタに行く気にはなりません。もちろん、他の人にはemacsは勧めません。
</p>

<p>
emacsは勧めませんが、emacsのキーバインドを覚えてもよいという奇特な方が
いらっしゃいましたら、是非ともorg-modeを使っていただきたいです。
というか、当然バリバリと使われているものと思います。もしご存じないなら
org-modeについては、<a href="http://emacs.rubikitch.com/sd1502-org-mode/">るびきちさんのサイト</a>を見ていただくのがよいでしょう。
emacsへの愛に溢れたページです。
</p>
</div>
</div>

<div id="outline-container-orga0c5b7d" class="outline-3">
<h3 id="orga0c5b7d"><span class="section-number-3">2.2</span> どこのブログを使うか</h3>
<div class="outline-text-3" id="text-2-2">
<p>
ネットでいろいろと検索してみましたが、最初はgoogleの<a href="https://www.blogger.com/about/">Blogger</a>を使う気で
いました。無料の割に広告が出ず、自由度も高くてよさそうです。Bloggerに
ついていろいろと調べるうちにふと、先日アカウントを取得したgithubに
書けるのではないか、と思い当たりました。更にgithubでのブログについて
調べると、<a href="https://pages.github.com/">github pages</a>というものがあることがわかりました。
</p>
</div>
</div>

<div id="outline-container-orgb155400" class="outline-3">
<h3 id="orgb155400"><span class="section-number-3">2.3</span> どのサイトジェネレーターを使うか</h3>
<div class="outline-text-3" id="text-2-3">
<p>
次に、github pagesに使えるサイトジェネレーターを調べたところ、github
純正のJekyllとHugoあたりが人気なことがわかりましたが、せっかくPython
を覚えたことだし、Pythonで書かれた<a href="https://blog.getpelican.com/">Pelican</a>に挑戦することにしました。
参考: <a href="https://mizunashi-mana.github.io/blog/posts/2019/03/start-blog/">ブログ始めました 続くといいな日記</a>
</p>

<p>
ブログを書くのに、emacs + org-modeが使えるとよいなと思っていたので
調べたところ、ドンピシャなページを見つけました:
<a href="https://kwpav.github.io/pelican_org_mode.html">Kevins Notes : Pelican and Org Mode</a>
</p>

<p>
方針が決まったので、早速ブログ作成に取りかかります。
</p>
</div>
</div>

<div id="outline-container-org4e72e32" class="outline-3">
<h3 id="org4e72e32"><span class="section-number-3">2.4</span> Pelicanを使ってみる</h3>
<div class="outline-text-3" id="text-2-4">
<p>
Pelicanを使うにあたって、このサイトに全面的にお世話になりました。
<a href="https://blog.sotm.jp/2014/01/04/Pelican-Markdown-GithubPages-install-guide/">Pelican + Markdown + GitHub Pagesで管理するブログの作り方</a>
</p>

<p>
まずはこのサイトに従って、githubのブログ用レポジトリを作成します。
ここはそのままなので略します。
</p>
</div>

<div id="outline-container-org94d78b2" class="outline-4">
<h4 id="org94d78b2"><span class="section-number-4">2.4.1</span> 仮想環境作成</h4>
<div class="outline-text-4" id="text-2-4-1">
<p>
次いで、仮想環境を作ります。上記のサイトにも書かれていますが、
私のpyenv環境はこのようになっています。(一部ぼかしています)
</p>
<pre class="example">
(blg) ~/***** % pyenv versions
 system
 3.7.7
* 3.8.3 (set by /Users/*****/.pyenv/version)
</pre>


<p>
venvを使って、ブログ用の仮想環境を作成します。venvを使った仮想環境
作成については<a href="https://qiita.com/fiftystorm36/items/b2fd47cf32c7694adc2e">ここ</a>などを参考にしてください。
</p>
<pre class="example">
% python -m venv blg
% cd blg
% source bin/activate
(blg) ~/****/blg %
</pre>
</div>
</div>

<div id="outline-container-org9216058" class="outline-4">
<h4 id="org9216058"><span class="section-number-4">2.4.2</span> Pelicanの設定</h4>
<div class="outline-text-4" id="text-2-4-2">
<p>
Pelicanをインストールします。
</p>
<pre class="example">
% pip3 install pelican
</pre>


<p>
github pagesへのアップロードに使う ghp-import もインストールします。
</p>
<pre class="example">
% pip3 install ghp-import
</pre>


<p>
pelican-quickstartを使ってサイトにひな形を作ります。
</p>
<pre class="example">
% pelican-quickstart
</pre>

<p>
質問に答えていくと完了します。具体的には、上記のサイトを参考にして
ください。
</p>
</div>
</div>

<div id="outline-container-org5a02ac6" class="outline-4">
<h4 id="org5a02ac6"><span class="section-number-4">2.4.3</span> テーマを設定する</h4>
<div class="outline-text-4" id="text-2-4-3">
<p>
いくつかPelican向けの<a href="http://www.pelicanthemes.com/">themes</a>を試してみましたが、いまいちどうもしっくり
きません。結局は上記サイト推奨の<a href="https://github.com/duilio/pelican-octopress-theme">pelican-octopress-theme</a>に落ち着きました。
格好いいです。日本人好みなのでしょうか。。。インストールは上記サイトの
手順そのまま使わせていただきました。
</p>
<pre class="example">
% wget https://github.com/duilio/pelican-octopress-theme/archive/master.zip ; unzip -q master.zip ; rm -rf master.zip
</pre>


<p>
うちのMacにはなぜかwgetが入っていなかったのでインストールしています。
</p>
<pre class="example">
% brew install wget
</pre>
</div>
</div>

<div id="outline-container-org168d3f6" class="outline-4">
<h4 id="org168d3f6"><span class="section-number-4">2.4.4</span> org-modeでPelicanを使う</h4>
<div class="outline-text-4" id="text-2-4-4">
<p>
ここからは<a href="https://kwpav.github.io/pelican_org_mode.html">Kevins Notes : Pelican and Org Mode</a>に従います。
プラグインをインストールします。
</p>
<pre class="example">
% git clone --recursive https://github.com/getpelican/pelican-plugins
</pre>


<p>
そしてpelicanconf.pyに以下を設定します。(一部ぼかしています)
</p>
<pre class="example">
AUTHOR = 'きょうす kyos'
SITENAME = 'Dreaming in Brookline, MA 02446'

PATH = 'content'
STATIC_PATHS = ['images']

TIMEZONE = 'America/New_York'

DEFAULT_LANG = 'ja'

THEME = "/Users/*****/blg/themes/pelican-octopress-theme-master"
PLUGIN_PATHS = ["/Users/*****/blg/pelican-plugins"]
PLUGINS = ['org_reader']
ORG_READER_EMACS_LOCATION = '/Applications/Emacs.app/Contents/MacOS/Emacs'
</pre>


<p>
contentディレクトリに*.orgファイルを置き、ローカルで試してみます。
</p>
<pre class="example">
% ls content 
images		kideng.org	learnPython.org	startblog.org
</pre>

<p>
imagesはイメージファイルを置くディレクトリです。
orgファイルの先頭に、以下のようにヘッダーを追記しています。
</p>
<pre class="example">
#+TITLE: org-mode + pelican + githubでブログを始めてみる
#+DATE: 2020-07-01
#+CATEGORY: Blog
#+AUTHOR: kyos
#+PROPERTY: LANGUAGE ja
#+PROPERTY: SUMMARY emacsのorg-modeでブログに挑戦
#+PROPERTY: SLUG startblog
#+PROPERTY: MODIFIED [2020-07-25]
#+PROPERTY: TAGS blog, python, emacs
</pre>


<p>
いよいよ、orgファイルからサイトジェネレートし、Webサーバーを立ち上げます。
</p>
<pre class="example">
% pelican
% make serve
</pre>


<p>
ブラウザーから <a href="http://localhost:8000/">http://localhost:8000/</a> にアクセスしてみます。
<img src="./images/blog.png" alt="blog.png" />
感動です。格好良くできました。
</p>

<p>
実は、イメージファイルの埋め込みにかなり苦労しました。どこにイメージ
ファイルを置き、orgファイルからどのように参照するかで、だいぶ試行錯誤
しました。結局は、content/imagesディレクトリを作成してそこにイメージ
ファイルを置き、orgファイルからは
</p>
<pre class="example">
[[./images/blog.png]]
</pre>

<p>
のように参照すればよいことがわかりました。
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org5aa5a9c" class="outline-2">
<h2 id="org5aa5a9c"><span class="section-number-2">3</span> ブログを公開する</h2>
<div class="outline-text-2" id="text-3">
<p>
いよいよ全世界に向けて公開します。おそらく誰も気がつきませんが。。
再びこのサイトにお世話になります。
<a href="https://blog.sotm.jp/2014/01/04/Pelican-Markdown-GithubPages-install-guide/">Pelican + Markdown + GitHub Pagesで管理するブログの作り方</a>
</p>

<p>
gitを初期化します。
</p>
<pre class="example">
% git init
</pre>


<p>
ついで、アップロードするディレクトリを指定します。
</p>
<pre class="example">
% ghp-import output
</pre>


<p>
いよいよ、githubにアップロードします。
</p>
<pre class="example">
% git push https://github.com/achiwa912/achiwa912.github.io.git gh-pages:master
Enumerating objects: 72, done.
Counting objects: 100% (72/72), done.
Delta compression using up to 4 threads
Compressing objects: 100% (72/72), done.
Writing objects: 100% (72/72), 4.78 MiB | 747.00 KiB/s, done.
Total 72 (delta 20), reused 0 (delta 0)
remote: Resolving deltas: 100% (20/20), done.
To https://github.com/achiwa912/achiwa912.github.io.git
 * [new branch]      gh-pages -&gt; master
</pre>


<p>
なんだかえらく簡単ですが、おそるおそる見に行っています。
<img src="./images/upload.png" alt="upload.png" />
素晴らしい！ やりました！
</p>

<p>
修正、追加して再びアップロードするときは以下をします。
</p>
<pre class="example">
% ghp-import output
% git push https://github.com/achiwa912/achiwa912.github.io.git gh-pages:master
</pre>


<p>
私はsshに乗り換えたので、
</p>
<pre class="example">
% git push git@github.com:achiwa912/achiwa912.github.io.git gh-pages:master
</pre>


<p>
(8/13/2021更新)
しばらく放置していたら、pelicanがエラーを出力して動かなくなりました。OSをBig Surに上げたり、brewをアップデートしたりしたせいかもしれません。さんざんトラブルシュートした結果、 <code>pip install --upgrade pelican</code> と <code>git pull</code> で(とりあえず)解決しました。
</p>
</div>
</div>
</div>
    <footer>
<p class="meta">
  <span class="byline author vcard">
    Posted by <span class="fn">
        きょうす
    </span>
  </span>
<time datetime="2020-07-01T00:00:00-04:00" pubdate>Wed 01 July 2020</time>  <span class="categories">
    <a class='category' href='/category/tech.html'>Tech</a>
  </span>
  <span class="categories">
    <a class="category" href="/tag/blog.html">blog</a>,    <a class="category" href="/tag/python.html">python</a>,    <a class="category" href="/tag/emacs.html">emacs</a>  </span>
</p><div class="sharing">
</div>    </footer>
  </article>

</div>
<aside class="sidebar">
  <section>
    <h1>Recent Posts</h1>
    <ul id="recent_posts">
      <li class="post">
          <a href="/taxret21.html">初めて自力で行うアメリカ確定申告</a>
      </li>
      <li class="post">
          <a href="/covid_vaccine.html">コロナワクチンの有効性について調査メモ</a>
      </li>
      <li class="post">
          <a href="/bkup_blog.html">ブログをバックアップする</a>
      </li>
      <li class="post">
          <a href="/ukraine.html">ウクライナ情勢調査メモ</a>
      </li>
      <li class="post">
          <a href="/colono.html">アメリカで大腸内視鏡検査(Colonoscopy)を受けた</a>
      </li>
    </ul>
  </section>
  <section>
      
    <h1>Categories</h1>
    <ul id="recent_posts">
        <li><a href="/category/blog.html">Blog</a></li>
        <li><a href="/category/english.html">English</a></li>
        <li><a href="/category/linux.html">Linux</a></li>
        <li><a href="/category/python.html">Python</a></li>
        <li><a href="/category/tech.html">Tech</a></li>
    </ul>
  </section>
 

  <section>
  <h1>Tags</h1>
    <a href="/tag/amerikasheng-huo.html">アメリカ生活</a>,    <a href="/tag/toraburu.html">トラブル</a>,    <a href="/tag/blog.html">Blog</a>,    <a href="/tag/tech.html">Tech</a>,    <a href="/tag/linux.html">Linux</a>,    <a href="/tag/investment.html">Investment</a>,    <a href="/tag/mac.html">Mac</a>,    <a href="/tag/python.html">Python</a>,    <a href="/tag/emacs.html">emacs</a>,    <a href="/tag/game.html">game</a>,    <a href="/tag/english.html">English</a>,    <a href="/tag/vacation.html">Vacation</a>,    <a href="/tag/ying-yu.html">英語</a>,    <a href="/tag/ying-yu-jiao-yu.html">英語教育</a>,    <a href="/tag/ying-jian.html">英検</a>  </section>


    <section>
        <h1>Social</h1>
        <ul>
            <li><a href="http://twitter.com/kyos_achwan" target="_blank">Twitter</a></li>
            <li><a href="http://github.com/achiwa912" target="_blank">GitHub</a></li>
        </ul>
    </section>
    <section>
        <h1>Blogroll</h1>
        <ul>
            <li><a href="https://getpelican.com/" target="_blank">Pelican</a></li>
            <li><a href="https://www.python.org/" target="_blank">Python.org</a></li>
        </ul>
    </section>

<section>
    <p>Follow <a href="http://twitter.com/kyos_achwan">@kyos_achwan</a></p>
</section>
</aside>    </div>
  </div>
  <footer role="contentinfo"><p>
    Copyright &copy;  2020&ndash;2022  きょうす kyos &mdash;
  <span class="credit">Powered by <a href="http://getpelican.com">Pelican</a></span>
</p></footer>
  <script src="/theme/js/modernizr-2.0.js"></script>
  <script src="/theme/js/ender.js"></script>
  <script src="/theme/js/octopress.js" type="text/javascript"></script>
</body>
</html>